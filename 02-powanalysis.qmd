---
title: "Taycleaning"
---

## Initial Questions

- What is the most common cause of power outages?
- What cause leads to the longest power outages?
- What state resolves issues the quickest? Longest?
- What state has the most outages? Least? -> Choropleth map, can do Texas and counties too

## Setup

```{r}
#| label: setup
#| message: false
#| warning: false

library(tidyverse)
library(janitor)
```

## Import multiple files

```{r}
#| label: import

power_files_list <- list.files(
  "data-processed-power",
  full.names = T
)

power_files_list
```

```{r}
#| label: combine-files

power_all <- map(
  power_files_list,
  read_csv
) |>
  list_rbind() |>
  clean_names()

power_all |> glimpse()
```

## Longest Outage Events

```{r}
power_all |> arrange(duration |> desc()) 
```


## What is the most common cause of power outages?

```{r}
power_all |> group_by (event_type) |> 
  summarize(total_events = n()) |> 
  arrange(total_events |> desc())
```
Need to create a new column for event_type categories that are similar

## What cause leads to the longest power outages?

```{r}
power_all |> group_by (event_type) |> # change event_type to event category
  summarize(avg_outage_length = mean(duration), total_occurences = n()) |> 
  arrange(avg_outage_length |> desc(), total_occurences)
```

## What state resolves issues the quickest? slowest?

```{r}
power_all |> group_by (state_event) |> 
  summarize(avg_event_length = mean(duration), total_occurences = n()) |> 
  arrange(avg_event_length)
```

```{r}
power_all |> group_by (state_event) |> 
  summarize(avg_event_length = mean(duration), total_occurences = n()) |> 
  arrange(avg_event_length |> desc())
```

## What state has the most outages? Least?

```{r}
power_all |> group_by (state_event) |> 
  summarize(total_outages = n()) |> 
  arrange(total_outages |> desc())
```

```{r}
power_all |> group_by (state_event) |> 
  summarize(total_outages = n()) |> 
  arrange(total_outages)
```

## Chloropleth graph
