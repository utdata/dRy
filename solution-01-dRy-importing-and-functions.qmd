---
title: "Importing and function solutions"
format: html
---

## Set up

Importing our needed libraries. We use tidyverse for almost everything.

```{r}

#| label: setup   #<1>
#| message: false #<2>
#| warning: false #<3>

library(tidyverse)
library(janitor)

```

# Importing multiple files at once

```{r}
#| label: import-oyo

power_files_list <- list.files(
  "data-processed-power",
  full.names = T
)

power_files_list

```

```{r}
#| label: combine-files-oyo

power_all <- map(
  power_files_list,
  read_csv
) |>
  list_rbind() |>
  clean_names()

power_all |> glimpse()
```

```{r}
#| lable: function

# do i need to pivot this, or am i doing something else completely wrong.

graphing_function <- function(power_data) {
  ggplot(power_data, aes(x = total_events, y = state_event) +
        geom_bar() +
        labs(x = "Outage cause", y = "Occurances"))
}

texas <- power_all |> filter(state_event |> str_detect("Texas")) |> 
  group_by (event_category) |> #<1>
  summarize(total_events = n()) |> #<2>
  arrange(total_events |> desc()) 

texas

graphing_function(texas)
```

